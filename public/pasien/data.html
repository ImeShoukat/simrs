<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIMRS - Data Pasien</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
</head>
<body class="bg-gray-50">
    <!-- Sidebar dari komponen -->
    <div id="sidebar-container"></div>
    <script>
      fetch('../../src/components/sidebar.html')
        .then(res => res.text())
        .then(html => {
          document.getElementById('sidebar-container').innerHTML = html;
        });
    </script>

    <div class="ml-64 min-h-screen">
        <div class="bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between">
            <div class="flex items-center">
                <button class="md:hidden mr-4" onclick="toggleSidebar()">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                    </svg>
                </button>
            </div>
            <div class="flex items-center">
                <div class="flex items-center mr-4">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z" clip-rule="evenodd"/>
                    </svg>
                    <span class="text-gray-700">Admin</span>
                </div>
                <button class="text-gray-400 hover:text-gray-600" onclick="toggleDropdown()">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="p-6">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="px-6 py-4 border-b border-gray-200">
                    <div class="flex items-center justify-between">
                        <h1 class="text-2xl font-bold text-gray-800">DATA PASIEN</h1>
                        <div class="flex space-x-3">
                            <a href="tambah.html"><button class="flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors" onclick="showAddPatientModal()">
                                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                                </svg>
                                Tambah Pasien
                            </button>
                            </a>
                            <button class="flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors" onclick="exportData()">
                                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                                Ekspor
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- filter -->
                <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
                    <div class="px-0 py-4">
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4">
                            <div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">STATUS</label>
                                    <div class="relative">
                                        <select id="filterStatus" class="w-full py-3 px-4 pe-9 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white transition-all">
                                            <option value="">SEMUA</option>
                                            <option value="aktif">Aktif</option>
                                            <option value="tidak-aktif">Tidak Aktif</option>
                                            <option value="meninggal">Meninggal</option>
                                        </select>
                                        <span class="absolute inset-y-0 right-3 flex items-center pointer-events-none">
                                            <svg class="w-4 h-4 text-gray-800" fill="none" viewBox="0 0 24 24">
                                                <path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="m19 9-7 7-7-7"/>
                                            </svg>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">PENJAMIN</label>
                                    <div class="relative">
                                        <select id="filterInsurance" class="w-full py-3 px-4 pe-9 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white transition-all">
                                            <option value="">Semua Penjamin</option>
                                            <option value="UMUM">UMUM</option>
                                            <option value="BPJS">BPJS</option>
                                            <option value="Asuransi">Asuransi</option>
                                            <option value="Jasa Raharja">Jasa Raharja</option>
                                        </select>
                                        <span class="absolute inset-y-0 right-3 flex items-center pointer-events-none">
                                            <svg class="w-4 h-4 text-gray-800" fill="none" viewBox="0 0 24 24">
                                                <path stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="m19 9-7 7-7-7"/>
                                            </svg>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">JENIS KELAMIN</label>
                                    <div class="relative">
                                        <select id="filterGender" class="w-full py-3 px-4 pe-9 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white transition-all">
                                            <option value="">Semua</option>
                                            <option value="P">PEREMPUAN</option>
                                            <option value="L">LAKI-LAKI</option>
                                        </select>
                                        <span class="absolute inset-y-0 right-3 flex items-center pointer-events-none">
                                            <svg class="w-4 h-4 text-gray-800" fill="none" viewBox="0 0 24 24">
                                                <path stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="m19 9-7 7-7-7"/>
                                            </svg>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="md:col-span-2">

                                <label class="block text-sm font-medium mb-2"
                                    >TANGGAL REGISTRASI</label
                                >
                                <div class="flex flex-col sm:flex-row items-center gap-3">
                                    <input
                                    type="date"
                                    id="dateFrom"
                                    value="2025-07-16"
                                    class="w-full px-4 py-3 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                    />
                                    <span class="text-sm text-gray-600 font-medium">s.d.</span>
                                    <input
                                    type="date"
                                    id="dateTo"
                                    value="2025-07-16"
                                    class="w-full px-4 py-3 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                    />
                                </div>
                                </div>
                        </div>
                        <div class="flex flex-col sm:flex-row justify-between items-end gap-4">
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Pencarian</label>
                                <input type="text" id="searchInput" placeholder="Cari NRM, Nama, ..." class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div class="flex items-end">
                                <button onclick="resetFilter()" class="bg-red-100 hover:bg-red-200 text-red-600 px-4 py-2 rounded-lg text-sm transition-colors">
                                    Reset <i class="fas fa-redo ml-1"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Table Section -->
                    <div class="bg-white rounded-lg shadow-sm border overflow-hidden">
                        <div class="overflow-x-auto relative">
                            <table class="w-full min-w-[1200px]">
                                <thead class="bg-blue-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-700 uppercase">AKSI</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-700 uppercase">NO. RM</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-700 uppercase">NAMA PASIEN</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-700 uppercase">NIK</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-700 uppercase">UMUR</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-700 uppercase">JK</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-700 uppercase">NO TELP</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-700 uppercase">PENJAMIN</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-700 uppercase">STATUS</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="patientTableBody">
                                <!-- Data will be populated here -->
                            </tbody>
                            </table>
                        </div>
                        <!-- Pagination -->
                        <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                            <div class="text-sm text-gray-700">
                                <span id="paginationInfo">Menampilkan 1 - 10 dari 100 data</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <button class="px-3 py-2 text-sm text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg">
                                        <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="px-3 py-2 text-sm bg-blue-600 text-white rounded-lg">1</button>
                                <button class="px-3 py-2 text-sm text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg">2</button>
                                <button class="px-3 py-2 text-sm text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg">3</button>
                                    <span class="px-2 text-gray-500">...</span>
                                <button class="px-3 py-2 text-sm text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg">10</button>
                                <button class="px-3 py-2 text-sm text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
                

                <!-- popup view -->
                <div id="modalDetailPasien" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden justify-center items-center">
                <div class="bg-white rounded-lg shadow-lg w-full max-w-4xl p-9 relative">

                    <h2 id="modalNamaPasien" class="text-xl font-bold mb-2">NY. Nama Pasien</h2>
                    <p class="text-sm text-gray-500 mb-6">NRM. <span id="modalNRM">000000</span> | Terdaftar: <span id="modalTerdaftar">-</span></p>

                    <div class="grid grid-cols-2 gap-6 text-sm">
                        <div>
                            <p><strong>NIK:</strong> <span id="modalNIK"></span></p>
                            <p><strong>Tanggal Lahir:</strong> <span id="modalTglLahir"></span></p>
                            <p><strong>Tempat Lahir:</strong> <span id="modalTempatLahir"></span></p>
                            <p><strong>Jenis Kelamin:</strong> <span id="modalJK"></span></p>
                            <p><strong>No. Telp PJ:</strong> <span id="modalTelpPJ"></span></p>
                            <p><strong>Golongan Darah:</strong> <span id="modalGolDarah"></span></p>
                            <p><strong>Status Nikah:</strong> <span id="modalStatusNikah"></span></p>
                            <p><strong>Pekerjaan:</strong> <span id="modalPekerjaan"></span></p>
                            <p><strong>Catatan Khusus:</strong> <span id="modalCatatan"></span></p>
                            <p><strong>Alamat:</strong> <span id="modalAlamat"></span></p>
                        </div>
                        <div>
                            <p><strong>Penanggung Jawab:</strong> <span id="modalPJ"></span></p>
                            <p><strong>Nama PJ:</strong> <span id="modalNamaPJ"></span></p>
                            <p><strong>Pekerjaan PJ:</strong> <span id="modalPekerjaanPJ"></span></p>
                            <p><strong>Penjamin:</strong> <span id="modalPenjamin"></span></p>
                            <p><strong>Nama Instansi:</strong> <span id="modalInstansi"></span></p>
                            <p><strong>No. Surat Penjamin:</strong> <span id="modalSurat"></span></p>
                            <p><strong>Asal Rujukan:</strong> <span id="modalAsalRujukan"></span></p>
                            <p><strong>No. Surat Rujukan:</strong> <span id="modalNoRujukan"></span></p>
                            <p><strong>Riwayat Kunjungan:</strong> <span id="modalKunjungan"></span></p>
                            <p><strong>Layanan Terakhir:</strong> <span id="modalLayanan"></span></p>
                        </div>
                        </div>
                        <div class="flex justify-end mt-6 space-x-2">
                            <button onclick="closeDetailModal()" class="px-6 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md font-medium transition-colors">Tutup</button>
                            <button onclick="window.print()" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md font-medium transition-colors">Print Data</button>
    
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- pop up alert delete -->
            <div id="popupModal" class="fixed inset-0 z-50 bg-black/50 flex items-center justify-center hidden">
                
                <div class="bg-white rounded-xl p-6 w-full max-w-sm text-center shadow-lg">
                    
                    <div class="flex justify-center mb-4">
                        <svg class="w-8 h-8 text-yellow-500" fill="none" stroke="currentColor" stroke-width="2"
                            viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round"
                            d="M12 9v2m0 4h.01M4.93 4.93l14.14 14.14M19.07 4.93L4.93 19.07" />
                        </svg>
                    </div>

                    <h2 class="text-lg font-semibold text-gray-900">Anda Yakin Akan Menghapus Data Pasien Ini?</h2>
                    <p class="text-sm text-gray-500 mt-1">Aksi ini akan menghapus Data Pasien dari Database</p>

                    <div class="mt-6 flex justify-center gap-4">
                        <button onclick="closeModal()" class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium">Cancel</button>
                        <button onclick="hapusPasien()" class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium">Hapus</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const sampleData = [
        {
            id: "1",
            nrm: "000001",
            nama: "Hana Qurratu A'yun",
            nik: "3302207705080003",
            tanggalLahir: "08 Mei 2007",
            tempatLahir: "Tegal",
            jenisKelamin: "L",
            noTelpPJ: "08123456889",
            golonganDarah: "O",
            statusNikah: "Belum Menikah",
            pekerjaan: "Pelajar",
            catatanKhusus: "-",
            alamat: "Jl. Mawar No. 1, Tegal",
            penanggungJawab: "Ayah",
            namaPJ: "Budi Santoso",
            pekerjaanPJ: "Wiraswasta",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "123456789",
            asalRujukan: "Puskesmas Tegal",
            noRujukan: "RUJ001",
            kunjunganTerakhir: "3 kali kunjungan",
            layananTerakhir: "Poli Umum",
            tanggalTerdaftar: "2023-02-10"
        },
        {
            id: "2",
            nrm: "000002",
            nama: "Ahmad Wijaya",
            nik: "3302157808950001",
            tanggalLahir: "08 Agustus 1995",
            tempatLahir: "Jakarta",
            jenisKelamin: "L",
            noTelpPJ: "08123456890",
            golonganDarah: "A",
            statusNikah: "Menikah",
            pekerjaan: "Karyawan Swasta",
            catatanKhusus: "Alergi seafood",
            alamat: "Jl. Melati No. 15, Jakarta Selatan",
            penanggungJawab: "Istri",
            namaPJ: "Siti Rahayu",
            pekerjaanPJ: "Ibu Rumah Tangga",
            penjamin: "Umum",
            status: "Aktif",
            nama_instansi: "-",
            nomor_surat: "-",
            asalRujukan: "Datang Sendiri",
            noRujukan: "-",
            kunjunganTerakhir: "1 kali kunjungan",
            layananTerakhir: "Poli Gigi",
            tanggalTerdaftar: "2023-05-30"
        },
        {
            id: "3",
            nrm: "000003",
            nama: "Siti Nurhaliza",
            nik: "3302226512920002",
            tanggalLahir: "25 Desember 1992",
            tempatLahir: "Bandung",
            jenisKelamin: "P",
            noTelpPJ: "08123456891",
            golonganDarah: "B",
            statusNikah: "Belum Menikah",
            pekerjaan: "Guru",
            catatanKhusus: "-",
            alamat: "Jl. Anggrek No. 7, Bandung",
            penanggungJawab: "Orang Tua",
            namaPJ: "Budi Prasetyo",
            pekerjaanPJ: "PNS",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "987654321",
            asalRujukan: "Puskesmas Bandung Timur",
            noRujukan: "RUJ002",
            kunjunganTerakhir: "5 kali kunjungan",
            layananTerakhir: "Poli Kandungan",
            tanggalTerdaftar: "2023-09-22"
        },
        {
            id: "4",
            nrm: "000004",
            nama: "Dedi Kurniawan",
            nik: "3302301075850004",
            tanggalLahir: "10 Juli 1985",
            tempatLahir: "Surabaya",
            jenisKelamin: "L",
            noTelpPJ: "08123456892",
            golonganDarah: "AB",
            statusNikah: "Menikah",
            pekerjaan: "Dokter",
            catatanKhusus: "Diabetes",
            alamat: "Jl. Kenanga No. 12, Surabaya",
            penanggungJawab: "Istri",
            namaPJ: "Rina Sari",
            pekerjaanPJ: "Apoteker",
            penjamin: "Asuransi",
            status: "Aktif",
            nama_instansi: "Allianz Indonesia",
            nomor_surat: "ALZ789012",
            asalRujukan: "RS Siloam",
            noRujukan: "RUJ003",
            kunjunganTerakhir: "8 kali kunjungan",
            layananTerakhir: "Poli Jantung",
            tanggalTerdaftar: "2024-01-01"
        },
        {
            id: "5",
            nrm: "000005",
            nama: "Maya Indira",
            nik: "3302114503880005",
            tanggalLahir: "05 Maret 1988",
            tempatLahir: "Yogyakarta",
            jenisKelamin: "P",
            noTelpPJ: "08123456893",
            golonganDarah: "O",
            statusNikah: "Menikah",
            pekerjaan: "Bidan",
            catatanKhusus: "Hamil 7 bulan",
            alamat: "Jl. Dahlia No. 20, Yogyakarta",
            penanggungJawab: "Suami",
            namaPJ: "Andi Pratama",
            pekerjaanPJ: "Insinyur",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "456789123",
            asalRujukan: "Bidan Praktek",
            noRujukan: "RUJ004",
            kunjunganTerakhir: "12 kali kunjungan",
            layananTerakhir: "Poli Kandungan",
            tanggalTerdaftar: "2024-02-10"
        },
        {
            id: "6",
            nrm: "000006",
            nama: "Rudi Hermawan",
            nik: "3302282209780006",
            tanggalLahir: "22 September 1978",
            tempatLahir: "Solo",
            jenisKelamin: "L",
            noTelpPJ: "08123456894",
            golonganDarah: "A",
            statusNikah: "Menikah",
            pekerjaan: "Polisi",
            catatanKhusus: "Cedera punggung",
            alamat: "Jl. Flamboyan No. 8, Solo",
            penanggungJawab: "Istri",
            namaPJ: "Dewi Kartika",
            pekerjaanPJ: "Perawat",
            penjamin: "Jamkesda",
            status: "Aktif",
            nama_instansi: "Jamkesda Solo",
            nomor_surat: "JKD345678",
            asalRujukan: "Puskesmas Solo",
            noRujukan: "RUJ005",
            kunjunganTerakhir: "4 kali kunjungan",
            layananTerakhir: "Poli Saraf",
            tanggalTerdaftar: "2024-02-10"
        },
        {
            id: "7",
            nrm: "000007",
            nama: "Lina Marlina",
            nik: "3302155611900007",
            tanggalLahir: "16 November 1990",
            tempatLahir: "Malang",
            jenisKelamin: "P",
            noTelpPJ: "08123456895",
            golonganDarah: "B",
            statusNikah: "Belum Menikah",
            pekerjaan: "Mahasiswa",
            catatanKhusus: "-",
            alamat: "Jl. Tulip No. 5, Malang",
            penanggungJawab: "Orang Tua",
            namaPJ: "Sutrisno",
            pekerjaanPJ: "Petani",
            penjamin: "BPJS",
            status: "Non-Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "789123456",
            asalRujukan: "Puskesmas Malang",
            noRujukan: "RUJ006",
            kunjunganTerakhir: "2 kali kunjungan",
            layananTerakhir: "Poli Mata",
            tanggalTerdaftar: "2024-03-10"
        },
        {
            id: "8",
            nrm: "000008",
            nama: "Bambang Supriyanto",
            nik: "3302120408650008",
            tanggalLahir: "04 Agustus 1965",
            tempatLahir: "Semarang",
            jenisKelamin: "L",
            noTelpPJ: "08123456896",
            golonganDarah: "AB",
            statusNikah: "Menikah",
            pekerjaan: "Pensiunan",
            catatanKhusus: "Hipertensi",
            alamat: "Jl. Cempaka No. 25, Semarang",
            penanggungJawab: "Anak",
            namaPJ: "Sari Dewi",
            pekerjaanPJ: "Dokter",
            penjamin: "Umum",
            status: "Aktif",
            nama_instansi: "-",
            nomor_surat: "-",
            asalRujukan: "Datang Sendiri",
            noRujukan: "-",
            kunjunganTerakhir: "15 kali kunjungan",
            layananTerakhir: "Poli Dalam",
            tanggalTerdaftar: "2024-03-11"
        },
        {
            id: "9",
            nrm: "000009",
            nama: "Fitri Handayani",
            nik: "3302248902930009",
            tanggalLahir: "09 Februari 1993",
            tempatLahir: "Medan",
            jenisKelamin: "P",
            noTelpPJ: "08123456897",
            golonganDarah: "O",
            statusNikah: "Menikah",
            pekerjaan: "Farmasis",
            catatanKhusus: "Alergi antibiotik",
            alamat: "Jl. Bougenville No. 18, Medan",
            penanggungJawab: "Suami",
            namaPJ: "Reza Pahlawan",
            pekerjaanPJ: "Pilot",
            penjamin: "Asuransi",
            status: "Aktif",
            nama_instansi: "Prudential",
            nomor_surat: "PRU567890",
            asalRujukan: "Klinik Pratama",
            noRujukan: "RUJ007",
            kunjunganTerakhir: "6 kali kunjungan",
            layananTerakhir: "Poli Kulit",
            tanggalTerdaftar: "2024-05-09"
        },
        {
            id: "10",
            nrm: "000010",
            nama: "Agus Setiawan",
            nik: "3302071203870010",
            tanggalLahir: "12 Maret 1987",
            tempatLahir: "Palembang",
            jenisKelamin: "L",
            noTelpPJ: "08123456898",
            golonganDarah: "A",
            statusNikah: "Belum Menikah",
            pekerjaan: "Programmer",
            catatanKhusus: "Mata minus",
            alamat: "Jl. Sakura No. 3, Palembang",
            penanggungJawab: "Orang Tua",
            namaPJ: "Hadi Wijaya",
            pekerjaanPJ: "Guru",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "234567890",
            asalRujukan: "Puskesmas Palembang",
            noRujukan: "RUJ008",
            kunjunganTerakhir: "7 kali kunjungan",
            layananTerakhir: "Poli Mata",
            tanggalTerdaftar: "2024-09-05"
        },
        {
            id: "11",
            nrm: "000011",
            nama: "Nina Septiana",
            nik: "3302196707860011",
            tanggalLahir: "27 Juli 1986",
            tempatLahir: "Makassar",
            jenisKelamin: "P",
            noTelpPJ: "08123456899",
            golonganDarah: "B",
            statusNikah: "Janda",
            pekerjaan: "Wartawan",
            catatanKhusus: "Asma",
            alamat: "Jl. Melur No. 14, Makassar",
            penanggungJawab: "Saudara",
            namaPJ: "Anto Setiawan",
            pekerjaanPJ: "Pengusaha",
            penjamin: "Umum",
            status: "Non-Aktif",
            nama_instansi: "-",
            nomor_surat: "-",
            asalRujukan: "Datang Sendiri",
            noRujukan: "-",
            kunjunganTerakhir: "9 kali kunjungan",
            layananTerakhir: "Poli Paru",
            tanggalTerdaftar: "2024-10-03"
        },
        {
            id: "12",
            nrm: "000012",
            nama: "Hendro Prasetyo",
            nik: "3302081404750012",
            tanggalLahir: "14 April 1975",
            tempatLahir: "Pontianak",
            jenisKelamin: "L",
            noTelpPJ: "08123456800",
            golonganDarah: "AB",
            statusNikah: "Menikah",
            pekerjaan: "Arsitek",
            catatanKhusus: "Kolesterol tinggi",
            alamat: "Jl. Teratai No. 9, Pontianak",
            penanggungJawab: "Istri",
            namaPJ: "Yuli Astuti",
            pekerjaanPJ: "Desainer",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "345678901",
            asalRujukan: "Puskesmas Pontianak",
            noRujukan: "RUJ009",
            kunjunganTerakhir: "11 kali kunjungan",
            layananTerakhir: "Poli Jantung",
            tanggalTerdaftar: "2024-12-25"
        },
        {
            id: "13",
            nrm: "000013",
            nama: "Ratna Sari Dewi",
            nik: "3302251805890013",
            tanggalLahir: "18 Mei 1989",
            tempatLahir: "Denpasar",
            jenisKelamin: "P",
            noTelpPJ: "08123456801",
            golonganDarah: "O",
            statusNikah: "Menikah",
            pekerjaan: "Chef",
            catatanKhusus: "Gastritis",
            alamat: "Jl. Kamboja No. 22, Denpasar",
            penanggungJawab: "Suami",
            namaPJ: "Made Santika",
            pekerjaanPJ: "Tour Guide",
            penjamin: "Asuransi",
            status: "Aktif",
            nama_instansi: "AXA Mandiri",
            nomor_surat: "AXA890123",
            asalRujukan: "RS Sanglah",
            noRujukan: "RUJ010",
            kunjunganTerakhir: "13 kali kunjungan",
            layananTerakhir: "Poli Dalam",
            tanggalTerdaftar: "2025-01-07"
        },
        {
            id: "14",
            nrm: "000014",
            nama: "Fajar Ramadhan",
            nik: "3302090601940014",
            tanggalLahir: "06 Januari 1994",
            tempatLahir: "Balikpapan",
            jenisKelamin: "L",
            noTelpPJ: "08123456802",
            golonganDarah: "A",
            statusNikah: "Belum Menikah",
            pekerjaan: "Teknisi",
            catatanKhusus: "-",
            alamat: "Jl. Seroja No. 11, Balikpapan",
            penanggungJawab: "Orang Tua",
            namaPJ: "Sumarno",
            pekerjaanPJ: "Buruh",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "567890234",
            asalRujukan: "Puskesmas Balikpapan",
            noRujukan: "RUJ011",
            kunjunganTerakhir: "4 kali kunjungan",
            layananTerakhir: "Poli Bedah",
            tanggalTerdaftar: "2025-02-10"
        },
        {
            id: "15",
            nrm: "000015",
            nama: "Indah Permata Sari",
            nik: "3302132110910015",
            tanggalLahir: "21 Oktober 1991",
            tempatLahir: "Padang",
            jenisKelamin: "P",
            noTelpPJ: "08123456803",
            golonganDarah: "B",
            statusNikah: "Menikah",
            pekerjaan: "Psikolog",
            catatanKhusus: "Anemia",
            alamat: "Jl. Magnolia No. 6, Padang",
            penanggungJawab: "Suami",
            namaPJ: "Rizki Pratama",
            pekerjaanPJ: "Akuntan",
            penjamin: "Umum",
            status: "Aktif",
            nama_instansi: "-",
            nomor_surat: "-",
            asalRujukan: "Datang Sendiri",
            noRujukan: "-",
            kunjunganTerakhir: "10 kali kunjungan",
            layananTerakhir: "Poli Dalam",
            tanggalTerdaftar: "2025-02-10"
        },
        {
            id: "16",
            nrm: "000016",
            nama: "SITI NURHALIZA",
            nik: "3309014512850001",
            tanggalLahir: "05 Desember 1985",
            tempatLahir: "Pemalang",
            jenisKelamin: "P",
            noTelpPJ: "0812-3456-7890",
            golonganDarah: "A+",
            statusNikah: "Menikah",
            pekerjaan: "Ibu Rumah Tangga",
            catatanKhusus: "Alergi Penisilin",
            alamat: "Jl. Sudirman No. 123, Pemalang",
            penanggungJawab: "Suami",
            namaPJ: "Ahmad Fauzi",
            pekerjaanPJ: "Karyawan Swasta",
            penjamin: "BPJS Kesehatan",
            status: "Tidak Aktif",
            nama_instansi: "BPJS Kesehatan Cabang Pemalang",
            nomor_surat: "0001793456789",
            asalRujukan: "Puskesmas Pemalang I",
            noRujukan: "001/RUJ/PSK-PML/VII/2025",
            kunjunganTerakhir: "5 kali kunjungan",
            layananTerakhir: "Poliklinik Kandungan",
            tanggalTerdaftar: "2025-05-10"
            },
        {
            id: "17",
            nrm: "000017",
            nama: "Sari Melati",
            nik: "3302172305850017",
            tanggalLahir: "23 Mei 1985",
            tempatLahir: "Batam",
            jenisKelamin: "P",
            noTelpPJ: "08123456805",
            golonganDarah: "A",
            statusNikah: "Belum Menikah",
            pekerjaan: "Sekretaris",
            catatanKhusus: "Migrain",
            alamat: "Jl. Nagoya No. 12, Batam",
            penanggungJawab: "Orang Tua",
            namaPJ: "Ahmad Yusuf",
            pekerjaanPJ: "Nelayan",
            penjamin: "Umum",
            status: "Aktif",
            nama_instansi: "-",
            nomor_surat: "-",
            asalRujukan: "Datang Sendiri",
            noRujukan: "-",
            kunjunganTerakhir: "8 kali kunjungan",
            layananTerakhir: "Poli Saraf"
        },
        {
            id: "18",
            nrm: "000018",
            nama: "Eko Prasetyo",
            nik: "3302260911770018",
            tanggalLahir: "09 November 1977",
            tempatLahir: "Pekanbaru",
            jenisKelamin: "L",
            noTelpPJ: "08123456806",
            golonganDarah: "B",
            statusNikah: "Menikah",
            pekerjaan: "Mekanik",
            catatanKhusus: "Cedera tangan kiri",
            alamat: "Jl. Sudirman No. 88, Pekanbaru",
            penanggungJawab: "Istri",
            namaPJ: "Wati Suherni",
            pekerjaanPJ: "Pedagang",
            penjamin: "Jamkesda",
            status: "Non-Aktif",
            nama_instansi: "Jamkesda Pekanbaru",
            nomor_surat: "JKD789012",
            asalRujukan: "Puskesmas Pekanbaru",
            noRujukan: "RUJ013",
            kunjunganTerakhir: "12 kali kunjungan",
            layananTerakhir: "Poli Bedah"
        },
        {
            id: "19",
            nrm: "000019",
            nama: "Diana Kusuma",
            nik: "3302301407920019",
            tanggalLahir: "14 Juli 1992",
            tempatLahir: "Manado",
            jenisKelamin: "P",
            noTelpPJ: "08123456807",
            golonganDarah: "AB",
            statusNikah: "Menikah",
            pekerjaan: "Perawat",
            catatanKhusus: "Hamil 5 bulan",
            alamat: "Jl. Sam Ratulangi No. 30, Manado",
            penanggungJawab: "Suami",
            namaPJ: "Robert Manoppo",
            pekerjaanPJ: "Pegawai Bank",
            penjamin: "Asuransi",
            status: "Aktif",
            nama_instansi: "Jasindo",
            nomor_surat: "JAS456789",
            asalRujukan: "Bidan Praktek",
            noRujukan: "RUJ014",
            kunjunganTerakhir: "14 kali kunjungan",
            layananTerakhir: "Poli Kandungan"
        },
        {
            id: "20",
            nrm: "000020",
            nama: "Hendra Gunawan",
            nik: "3302151203830020",
            tanggalLahir: "12 Maret 1983",
            tempatLahir: "Jambi",
            jenisKelamin: "L",
            noTelpPJ: "08123456808",
            golonganDarah: "O",
            statusNikah: "Duda",
            pekerjaan: "Supir",
            catatanKhusus: "Mata minus tinggi",
            alamat: "Jl. Jambi-Muaro No. 67, Jambi",
            penanggungJawab: "Anak",
            namaPJ: "Andi Gunawan",
            pekerjaanPJ: "Mahasiswa",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "789012456",
            asalRujukan: "Puskesmas Jambi",
            noRujukan: "RUJ015",
            kunjunganTerakhir: "3 kali kunjungan",
            layananTerakhir: "Poli Mata"
        },
        {
            id: "21",
            nrm: "000021",
            nama: "Putri Wulandari",
            nik: "3302088801960021",
            tanggalLahir: "08 Januari 1996",
            tempatLahir: "Bengkulu",
            jenisKelamin: "P",
            noTelpPJ: "08123456809",
            golonganDarah: "A",
            statusNikah: "Belum Menikah",
            pekerjaan: "Model",
            catatanKhusus: "Diet ketat",
            alamat: "Jl. Panorama No. 15, Bengkulu",
            penanggungJawab: "Orang Tua",
            namaPJ: "Hari Santoso",
            pekerjaanPJ: "Pengusaha",
            penjamin: "Umum",
            status: "Aktif",
            nama_instansi: "-",
            nomor_surat: "-",
            asalRujukan: "Datang Sendiri",
            noRujukan: "-",
            kunjungan_terakhir: "2 kali kunjungan",
            layananTerakhir: "Poli Gizi"
        },
        {
            id: "22",
            nrm: "000022",
            nama: "Wahyu Nugroho",
            nik: "3302290610740022",
            tanggalLahir: "06 Oktober 1974",
            tempatLahir: "Samarinda",
            jenisKelamin: "L",
            noTelpPJ: "08123456810",
            golonganDarah: "B",
            statusNikah: "Menikah",
            pekerjaan: "Pilot",
            catatanKhusus: "Gangguan pendengaran ringan",
            alamat: "Jl. Mahakam No. 77, Samarinda",
            penanggungJawab: "Istri",
            namaPJ: "Sinta Dewi",
            pekerjaanPJ: "Pramugari",
            penjamin: "Asuransi",
            status: "Aktif",
            nama_instansi: "Great Eastern",
            nomor_surat: "GE123789",
            asalRujukan: "Medical Check Up",
            noRujukan: "RUJ016",
            kunjunganTerakhir: "16 kali kunjungan",
            layananTerakhir: "Poli THT"
        },
        {
            id: "23",
            nrm: "000023",
            nama: "Anita Sari",
            nik: "3302117709880023",
            tanggalLahir: "17 September 1988",
            tempatLahir: "Banda Aceh",
            jenisKelamin: "P",
            noTelpPJ: "08123456811",
            golonganDarah: "AB",
            statusNikah: "Janda",
            pekerjaan: "Jurnalis",
            catatanKhusus: "Stress tinggi",
            alamat: "Jl. Cut Nyak Dien No. 33, Banda Aceh",
            penanggungJawab: "Saudara",
            namaPJ: "Ridwan Karim",
            pekerjaanPJ: "Dosen",
            penjamin: "BPJS",
            status: "Non-Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "890123567",
            asalRujukan: "Puskesmas Banda Aceh",
            noRujukan: "RUJ017",
            kunjunganTerakhir: "7 kali kunjungan",
            layananTerakhir: "Poli Jiwa"
        },
        {
            id: "24",
            nrm: "000024",
            nama: "Rizki Maulana",
            nik: "3302240501990024",
            tanggalLahir: "05 Januari 1999",
            tempatLahir: "Kupang",
            jenisKelamin: "L",
            noTelpPJ: "08123456812",
            golonganDarah: "O",
            statusNikah: "Belum Menikah",
            pekerjaan: "Atlet",
            catatanKhusus: "Cedera lutut",
            alamat: "Jl. El Tari No. 21, Kupang",
            penanggungJawab: "Pelatih",
            namaPJ: "Tommy Siahaan",
            pekerjaanPJ: "Pelatih Olahraga",
            penjamin: "Umum",
            status: "Aktif",
            nama_instansi: "-",
            nomor_surat: "-",
            asalRujukan: "Datang Sendiri",
            noRujukan: "-",
            kunjunganTerakhir: "18 kali kunjungan",
            layananTerakhir: "Poli Ortopedi"
        },
        {
            id: "25",
            nrm: "000025",
            nama: "Melani Putri",
            nik: "3302052612870025",
            tanggalLahir: "26 Desember 1987",
            tempatLahir: "Jayapura",
            jenisKelamin: "P",
            noTelpPJ: "08123456813",
            golonganDarah: "A",
            statusNikah: "Menikah",
            pekerjaan: "Dokter Gigi",
            catatanKhusus: "Alergi latex",
            alamat: "Jl. Raya Abepura No. 55, Jayapura",
            penanggungJawab: "Suami",
            namaPJ: "Daniel Wambrauw",
            pekerjaanPJ: "Pilot",
            penjamin: "Asuransi",
            status: "Aktif",
            nama_instansi: "Sinar Mas",
            nomor_surat: "SM789456",
            asalRujukan: "RS Dian Harapan",
            noRujukan: "RUJ018",
            kunjunganTerakhir: "5 kali kunjungan",
            layananTerakhir: "Poli Kulit"
        },
        {
            id: "26",
            nrm: "000026",
            nama: "Irwan Setiawan",
            nik: "3302191108810026",
            tanggalLahir: "11 Agustus 1981",
            tempatLahir: "Ambon",
            jenisKelamin: "L",
            noTelpPJ: "08123456814",
            golonganDarah: "B",
            statusNikah: "Menikah",
            pekerjaan: "Pegawai BUMN",
            catatanKhusus: "Asam urat tinggi",
            alamat: "Jl. Pattimura No. 42, Ambon",
            penanggungJawab: "Istri",
            namaPJ: "Martha Latuheru",
            pekerjaanPJ: "Guru",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "901234678",
            asalRujukan: "Puskesmas Ambon",
            noRujukan: "RUJ019",
            kunjunganTerakhir: "9 kali kunjungan",
            layananTerakhir: "Poli Dalam"
        },
        {
            id: "27",
            nrm: "000027",
            nama: "Yuni Kartika",
            nik: "3302033107940027",
            tanggalLahir: "31 Juli 1994",
            tempatLahir: "Ternate",
            jenisKelamin: "P",
            noTelpPJ: "08123456815",
            golonganDarah: "AB",
            statusNikah: "Belum Menikah",
            pekerjaan: "Fotografer",
            catatanKhusus: "-",
            alamat: "Jl. Sultan Khairun No. 18, Ternate",
            penanggungJawab: "Orang Tua",
            namaPJ: "Usman Bakar",
            pekerjaanPJ: "Pegawai Negeri",
            penjamin: "Jamkesda",
            status: "Non-Aktif",
            nama_instansi: "Jamkesda Ternate",
            nomor_surat: "JKD234567",
            asalRujukan: "Puskesmas Ternate",
            noRujukan: "RUJ020",
            kunjunganTerakhir: "4 kali kunjungan",
            layananTerakhir: "Poli Umum"
        },
        {
            id: "28",
            nrm: "000028",
            nama: "Arief Rahman",
            nik: "3302122909760028",
            tanggalLahir: "29 September 1976",
            tempatLahir: "Mataram",
            jenisKelamin: "L",
            noTelpPJ: "08123456816",
            golonganDarah: "O",
            statusNikah: "Menikah",
            pekerjaan: "Pengacara",
            catatanKhusus: "Maag kronis",
            alamat: "Jl. Gajah Mada No. 91, Mataram",
            penanggungJawab: "Istri",
            namaPJ: "Siti Aminah",
            pekerjaanPJ: "Notaris",
            penjamin: "Umum",
            status: "Aktif",
            nama_instansi: "-",
            nomor_surat: "-",
            asalRujukan: "Datang Sendiri",
            noRujukan: "-",
            kunjunganTerakhir: "11 kali kunjungan",
            layananTerakhir: "Poli Dalam"
        },
        {
            id: "29",
            nrm: "000029",
            nama: "Dewi Lestari",
            nik: "3302201406900029",
            tanggalLahir: "14 Juni 1990",
            tempatLahir: "Kendari",
            jenisKelamin: "P",
            noTelpPJ: "08123456817",
            golonganDarah: "A",
            statusNikah: "Menikah",
            pekerjaan: "Akuntan",
            catatanKhusus: "Hamil 3 bulan",
            alamat: "Jl. Haluoleo No. 25, Kendari",
            penanggungJawab: "Suami",
            namaPJ: "Andi Putra",
            pekerjaanPJ: "Insinyur",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "012345789",
            asalRujukan: "Bidan Praktek",
            noRujukan: "RUJ021",
            kunjunganTerakhir: "13 kali kunjungan",
            layananTerakhir: "Poli Kandungan"
        },
        {
            id: "30",
            nrm: "000030",
            nama: "Bayu Pranata",
            nik: "3302160802980030",
            tanggalLahir: "08 Februari 1998",
            tempatLahir: "Palu",
            jenisKelamin: "L",
            noTelpPJ: "08123456818",
            golonganDarah: "B",
            statusNikah: "Belum Menikah",
            pekerjaan: "Mahasiswa",
            catatanKhusus: "Patah tulang kaki kanan",
            alamat: "Jl. Tadulako No. 37, Palu",
            penanggungJawab: "Orang Tua",
            namaPJ: "Hasan Basri",
            pekerjaanPJ: "Tukang Kayu",
            penjamin: "BPJS",
            status: "Aktif",
            nama_instansi: "BPJS Kesehatan",
            nomor_surat: "123456890",
            asalRujukan: "IGD RS",
            noRujukan: "RUJ022",
            kunjunganTerakhir: "20 kali kunjungan",
            layananTerakhir: "Poli Bedah"
        }
        ];

        let selectedPatientId = null;
        let patientData = sampleData; // Use in-memory data instead of localStorage
        const rowsPerPage = 15; // Number of rows to display per page

        function deletePatient(id) {
            selectedPatientId = id;
            openModal();
        }

        function hapusPasien() {
            if (selectedPatientId) {
                // Remove from in-memory data
                patientData = patientData.filter(p => p.nrm !== selectedPatientId);
                closeModal();
                // You would typically reload the table here
                alert('Data pasien berhasil dihapus');
                location.reload();
            }
        }

        function openModal() {
            document.getElementById("popupModal").classList.remove("hidden");
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById("popupModal").classList.add("hidden");
            document.body.style.overflow = 'auto';
        }

        function toggleActionDropdown(button) {
            const dropdown = button.nextElementSibling;
            const isOpen = !dropdown.classList.contains("hidden");

            // Close all dropdowns first
            document.querySelectorAll('.dropdown-menu').forEach(d => d.classList.add('hidden'));
            
            // Open current dropdown if it was closed
            if (!isOpen) {
                dropdown.classList.remove("hidden");
            }
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const isClickInside = event.target.closest('.relative');
            if (!isClickInside) {
                document.querySelectorAll('.dropdown-menu').forEach(d => d.classList.add('hidden'));
            }
        });

        function showDetailModal(nrm) {
            const pasien = sampleData.find(p => p.nrm === nrm);
            if (!pasien) return;

            document.getElementById("modalNamaPasien").innerText = pasien.nama;
            document.getElementById("modalNRM").innerText = pasien.nrm;
            document.getElementById("modalTerdaftar").innerText = pasien.tanggalTerdaftar;
            document.getElementById("modalNIK").innerText = pasien.nik;
            document.getElementById("modalTglLahir").innerText = pasien.tanggalLahir;
            document.getElementById("modalTempatLahir").innerText = pasien.tempatLahir;
            document.getElementById("modalJK").innerText = pasien.jenisKelamin === "L" ? "Laki-laki" : "Perempuan";
            document.getElementById("modalTelpPJ").innerText = pasien.noTelpPJ || "-";
            document.getElementById("modalGolDarah").innerText = pasien.golonganDarah || "-";
            document.getElementById("modalStatusNikah").innerText = pasien.statusNikah || "-";
            document.getElementById("modalPekerjaan").innerText = pasien.pekerjaan;
            document.getElementById("modalCatatan").innerText = pasien.catatanKhusus || "-";
            document.getElementById("modalAlamat").innerText = pasien.alamat;
            document.getElementById("modalPJ").innerText = pasien.penanggungJawab;
            document.getElementById("modalNamaPJ").innerText = pasien.namaPJ || "-";
            document.getElementById("modalPekerjaanPJ").innerText = pasien.pekerjaanPJ || "-";
            document.getElementById("modalPenjamin").innerText = pasien.penjamin;
            document.getElementById("modalInstansi").innerText = pasien.nama_instansi || "-";
            document.getElementById("modalSurat").innerText = pasien.nomor_surat || "-";
            document.getElementById("modalAsalRujukan").innerText = pasien.asalRujukan || "-";
            document.getElementById("modalNoRujukan").innerText = pasien.noRujukan || "-";
            document.getElementById("modalKunjungan").innerText = pasien.kunjunganTerakhir || "-";
            document.getElementById("modalLayanan").innerText = pasien.layananTerakhir || "-";

            document.getElementById("modalDetailPasien").classList.remove("hidden");
            document.getElementById("modalDetailPasien").classList.add("flex");
            document.body.style.overflow = 'hidden';
            
            // Close dropdown after opening modal
            document.querySelectorAll('.dropdown-menu').forEach(menu => {
                menu.classList.add('hidden');
            });
        }

        function closeDetailModal() {
            document.getElementById("modalDetailPasien").classList.remove("flex");
            document.getElementById("modalDetailPasien").classList.add("hidden");
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking outside or pressing Escape
        document.getElementById('modalDetailPasien').addEventListener('click', function(e) {
            if (e.target === this) {
                closeDetailModal();
            }
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeDetailModal();
                closeModal();
            }
        });

        // Edit action: redirect to edit.html with nrm as query param
        function editPatient(nrm) {
            // Close dropdown first
            document.querySelectorAll('.dropdown-menu').forEach(menu => {
                menu.classList.add('hidden');
            });
            
            // For demo purposes, show alert. In real app, redirect to edit page
            alert(`Redirect ke halaman edit untuk pasien: ${nrm}`);
            // window.location.href = `edit.html?nrm=${nrm}`;
        }
        

// Fungsi untuk menghitung umur dari tanggal lahir
function calculateAge(tanggalLahir) {
    // Parse tanggal lahir (format: "08 Mei 2007")
    const months = {
        'Januari': 0, 'Februari': 1, 'Maret': 2, 'April': 3,
        'Mei': 4, 'Juni': 5, 'Juli': 6, 'Agustus': 7,
        'September': 8, 'Oktober': 9, 'November': 10, 'Desember': 11
    };
    
    const parts = tanggalLahir.split(' ');
    const day = parseInt(parts[0]);
    const month = months[parts[1]];
    const year = parseInt(parts[2]);
    
    const birthDate = new Date(year, month, day);
    const today = new Date();
    
    let age = today.getFullYear() - birthDate.getFullYear();
    const monthDiff = today.getMonth() - birthDate.getMonth();
    
    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
        age--;
    }
    
    return age;
}
function getStatusBadge(status) {
    const statusClass = status === 'Aktif' 
        ? 'bg-green-100 text-green-800' 
        : 'bg-red-100 text-red-800';
    
    return `<span class="px-2 py-1 text-xs font-medium rounded-full ${statusClass}">${status}</span>`;
}

// Fungsi utama untuk mengisi tabel
function populatePatientTable(data = patientData, page = 1) {
    const tableBody = document.getElementById('patientTableBody');
    if (!tableBody) return;

    // Pagination logic
    const totalRows = data.length;
    const totalPages = Math.ceil(totalRows / rowsPerPage);
    if (page < 1) page = 1;
    if (page > totalPages) page = totalPages;

    const start = (page - 1) * rowsPerPage;
    const end = start + rowsPerPage;
    const pageData = data.slice(start, end);

    // Kosongkan tabel
    tableBody.innerHTML = '';

    if (pageData.length === 0) {
        tableBody.innerHTML = `
            <tr>
                <td colspan="9" class="px-6 py-4 text-center text-gray-500">
                    Tidak ada data pasien
                </td>
            </tr>
        `;
    } else {
        pageData.forEach((patient, index) => {
            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50';
            row.innerHTML = `
                <td class="px-4 py-3 text-sm text-center">
                    <div class="relative inline-block">
                        <button onclick="toggleDropdown(${patient.id})" class="dropdown-btn px-3 py-2 text-blue-600 rounded text-xs hover:bg-blue-200 inline-flex items-center transition-colors cursor-pointer">
                            <svg class="w-4 h-4 text-blue-800" fill="none" viewBox="0 0 24 24">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 9-7 7-7-7"/>
                            </svg>
                        </button>
                        <div id="dropdown-${patient.id}" class="dropdown-content absolute left-0 top-full mt-1 bg-white min-w-48 shadow-lg border rounded-lg z-50 hidden">
                            <a href="javascript:void(0)" onclick="showDetailModal('${patient.nrm}')" class="flex items-center px-4 py-2 text-sm text-gray-600 hover:bg-gray-100">
                                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/>
                                    <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/>
                                </svg>Lihat</a>
                            <a href="edit.html" class="flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" onclick="editPatient('${patient.nrm}')">
                                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                                </svg>Edit</a>
                            <a href="#" class="flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50" onclick="deletePatient('${patient.nrm}')">
                                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd"/>
                                </svg>Hapus</a>
                        </div>
                    </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                    ${patient.nrm}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    ${patient.nama}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    ${patient.nik}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    ${calculateAge(patient.tanggalLahir)} tahun
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    ${patient.jenisKelamin === 'L' ? 'Laki-laki' : 'Perempuan'}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    ${patient.noTelpPJ}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    ${patient.penjamin}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    ${getStatusBadge(patient.status)}
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    // Update pagination info
    const info = document.getElementById('paginationInfo');
    if (info) {
        const showingFrom = totalRows === 0 ? 0 : start + 1;
        const showingTo = Math.min(end, totalRows);
        info.textContent = `Menampilkan ${showingFrom} - ${showingTo} dari ${totalRows} data`;
    }

    // Render pagination buttons
    renderPagination(totalPages, page);
}

populatePatientTable();

function toggleDropdown(id) {
    const dropdown = document.getElementById(`dropdown-${id}`);
    const isOpen = dropdown && !dropdown.classList.contains('hidden');

    // Tutup semua dropdown lain
    document.querySelectorAll('.dropdown-content').forEach(d => d.classList.add('hidden'));

    // Jika dropdown tadi belum terbuka, buka
    if (!isOpen && dropdown) {
        dropdown.classList.remove('hidden');
    }
}

// Tutup dropdown jika klik di luar tombol/dropdown
document.addEventListener('click', function(event) {
    const isDropdownBtn = event.target.closest('.dropdown-btn');
    const isDropdownContent = event.target.closest('.dropdown-content');
    if (!isDropdownBtn && !isDropdownContent) {
        document.querySelectorAll('.dropdown-content').forEach(d => d.classList.add('hidden'));
    }
});
function renderPagination(totalPages, current) {
    const container = document.querySelector('.flex.items-center.space-x-1');
    if (!container) return;

    container.innerHTML = '';

    // Tombol prev
    const prevBtn = document.createElement('button');
    prevBtn.className = "px-3 py-2 text-sm text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg";
    prevBtn.innerHTML = `<i class="fas fa-chevron-left"></i>`;
    prevBtn.disabled = current === 1;
    prevBtn.onclick = () => {
        if (current > 1) {
            currentPage = current - 1;
            populatePatientTable(patientData, currentPage);
        }
    };
    container.appendChild(prevBtn);

    // Tombol halaman (maksimal 5, dengan ... jika banyak)
    let startPage = Math.max(1, current - 2);
    let endPage = Math.min(totalPages, current + 2);
    if (current <= 3) endPage = Math.min(5, totalPages);
    if (current >= totalPages - 2) startPage = Math.max(1, totalPages - 4);

    if (startPage > 1) {
        const firstBtn = document.createElement('button');
        firstBtn.className = "px-3 py-2 text-sm text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg";
        firstBtn.textContent = "1";
        firstBtn.onclick = () => {
            currentPage = 1;
            populatePatientTable(patientData, 1);
        };
        container.appendChild(firstBtn);

        if (startPage > 2) {
            const dots = document.createElement('span');
            dots.className = "px-2 text-gray-500";
            dots.textContent = "...";
            container.appendChild(dots);
        }
    }

    for (let i = startPage; i <= endPage; i++) {
        const btn = document.createElement('button');
        btn.className = `px-3 py-2 text-sm rounded-lg ${i === current ? 'bg-blue-600 text-white' : 'text-gray-500 hover:text-gray-700 hover:bg-gray-100'}`;
        btn.textContent = i;
        btn.onclick = () => {
            currentPage = i;
            populatePatientTable(patientData, i);
        };
        container.appendChild(btn);
    }

    if (endPage < totalPages) {
        if (endPage < totalPages - 1) {
            const dots = document.createElement('span');
            dots.className = "px-2 text-gray-500";
            dots.textContent = "...";
            container.appendChild(dots);
        }
        const lastBtn = document.createElement('button');
        lastBtn.className = "px-3 py-2 text-sm text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg";
        lastBtn.textContent = totalPages;
        lastBtn.onclick = () => {
            currentPage = totalPages;
            populatePatientTable(patientData, totalPages);
        };
        container.appendChild(lastBtn);
    }

    // Tombol next
    const nextBtn = document.createElement('button');
    nextBtn.className = "px-3 py-2 text-sm text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg";
    nextBtn.innerHTML = `<i class="fas fa-chevron-right"></i>`;
    nextBtn.disabled = current === totalPages;
    nextBtn.onclick = () => {
        if (current < totalPages) {
            currentPage = current + 1;
            populatePatientTable(patientData, currentPage);
        }
    };
    container.appendChild(nextBtn);
}
let currentPage = 1;

// Ambil nilai filter dari form
function getFilterValues() {
    return {
        status: document.getElementById('filterStatus').value,
        insurance: document.getElementById('filterInsurance').value,
        gender: document.getElementById('filterGender').value,
        dateFrom: document.getElementById('dateFrom').value,
        dateTo: document.getElementById('dateTo').value,
        search: document.getElementById('searchInput').value.trim().toLowerCase()
    };
}

// Fungsi filter utama
function filterPatients() {
    const { status, insurance, gender, dateFrom, dateTo, search } = getFilterValues();

    let filtered = sampleData.filter(p => {
        // Status
        let statusMatch = !status || (p.status || '').toLowerCase().replace('-', '') === status.toLowerCase().replace('-', '');
        // Penjamin
        let insuranceMatch = !insurance || (p.penjamin || '').toLowerCase() === insurance.toLowerCase();
        // Gender
        let genderMatch = !gender || (p.jenisKelamin || '').toUpperCase() === gender.toUpperCase();
        // Date (dummy: tanggal registrasi tidak ada di data, skip or always true)
        let dateMatch = true;
        if (dateFrom) dateMatch = p.tanggalTerdaftar >= dateFrom;
        if (dateTo) dateMatch = dateMatch && p.tanggalTerdaftar <= dateTo;
        // Search
        let searchMatch = !search ||
            (p.nrm && p.nrm.toLowerCase().includes(search)) ||
            (p.nama && p.nama.toLowerCase().includes(search)) ||
            (p.nik && p.nik.toLowerCase().includes(search));

        return statusMatch && insuranceMatch && genderMatch && dateMatch && searchMatch;
    });

    patientData = filtered;
    currentPage = 1;
    populatePatientTable(patientData, currentPage);
}

// Reset filter
function resetFilter() {
    document.getElementById('filterStatus').value = '';
    document.getElementById('filterInsurance').value = '';
    document.getElementById('filterGender').value = '';
    document.getElementById('dateFrom').value = '';
    document.getElementById('dateTo').value = '';
    document.getElementById('searchInput').value = '';
    patientData = sampleData;
    currentPage = 1;
    populatePatientTable(patientData, currentPage);
}

// Event listeners untuk filter
document.getElementById('filterStatus').addEventListener('change', filterPatients);
document.getElementById('filterInsurance').addEventListener('change', filterPatients);
document.getElementById('filterGender').addEventListener('change', filterPatients);
document.getElementById('dateFrom').addEventListener('change', filterPatients);
document.getElementById('dateTo').addEventListener('change', filterPatients);
document.getElementById('searchInput').addEventListener('input', filterPatients);
    </script>
  </body>
</html>