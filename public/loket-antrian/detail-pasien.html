<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SIMRS - Detail Pasien</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              "blue-primary": "#4F46E5",
              "blue-light": "#EEF2FF",
              "gray-light": "#F8FAFC",
            },
          },
        },
      };
    </script>
  </head>
  <body class="bg-gray-50 font-inter">
    <!-- Kontainer Sidebar -->
    <div id="sidebar-container"></div>
    <script>
      fetch("../../src/components/sidebar.html")
        .then((res) => res.text())
        .then((html) => {
          document.getElementById("sidebar-container").innerHTML = html;
        });
    </script>

    <!-- Konten Utama -->
    <div class="lg:ml-64 min-h-screen">
      <!-- Header -->
      <header class="bg-white shadow-sm border-b sticky top-0 z-40">
        <div class="flex items-center justify-between px-4 lg:px-6 py-4">
          <nav class="flex items-center space-x-2 text-sm text-gray-600">
            <a href="dashboard.html" class="hover:text-gray-900">Home</a>
            <span>></span>
            <a href="dashboard.html" class="hover:text-gray-900">Loket Pendaftaran</a>
            <span>></span>
            <span class="text-gray-900 font-medium">Detail Pasien</span>
          </nav>
          <div class="flex items-center space-x-2">
            <span class="text-gray-700 hidden sm:block">Admin</span>
            <button class="p-2 rounded-lg hover:bg-gray-100">
              <i class="fas fa-user-circle text-gray-500"></i>
            </button>
          </div>
        </div>
      </header>

      <!-- Konten Utama -->
      <div class="p-4 lg:p-6">
        <div class="max-w-7xl mx-auto">
          <!-- Info Pasien -->
          <div class="bg-white rounded-lg shadow-sm border p-6 mb-6">
            <div class="flex items-start justify-between mb-6">
              <div>
                <div class="flex items-center space-x-3 mb-2">
                  <h1 id="patientName" class="text-2xl font-semibold text-gray-800">
                    Memuat...
                  </h1>
                  <span id="patientStatus" class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded-full">
                    Aktif
                  </span>
                </div>
                <p id="patientNRM" class="text-sm text-gray-500 mb-1">NRM: Memuat...</p>
                <p id="patientRegDate" class="text-sm text-gray-500">Tanggal Terdaftar: Memuat...</p>
              </div>
              <button 
                onclick="goBack()" 
                class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center space-x-2"
              >
                <i class="fas fa-arrow-left"></i>
                <span>Kembali</span>
                              </button>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                              <!-- Column 1 - Identitas -->
                              <div class="space-y-4">
                                <div>
                                  <label class="text-sm text-gray-700 font-bold">No. Reg</label>
                                  <p id="regNumber" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm text-gray-700 font-bold">NIK</label>
                                  <p id="nikNumber" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Tgl. Lahir / Umur</label>
                                  <p id="birthDate" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Jenis Kelamin</label>
                                  <p id="gender" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Alamat</label>
                                  <p id="address" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                              </div>

                              <!-- Column 2 - Pelayanan -->
                              <div class="space-y-4">
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Dokter PJ</label>
                                  <p id="doctor" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Jenis</label>
                                  <p id="payment" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Asal Rujukan</label>
                                  <p id="clinic" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-medium text-gray-700">No. Rujukan</label>
                                  <p id="rujukanNumber" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">No. BPJS / No. SEP</label>
                                  <p id="bpjsNumber" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Alergi</label>
                                  <p id="allergies" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Penyakit Khusus</label>
                                  <p id="specialConditions" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                              </div>

                              <!-- Column 3 - Penanggung Jawab -->
                              <div class="space-y-4">
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Penanggung Jawab</label>
                                  <p id="penanggungJawab" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">No. Telp PJ</label>
                                  <p id="phoneNumber" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div>
                                  <label class="text-sm font-bold text-gray-700">Hubungan dengan Pasien</label>
                                  <p id="hubunganPasien" class="text-sm text-gray-600">Memuat...</p>
                                </div>
                                <div class="text-sm text-gray-500">
                                  * Untuk mengganti data Penanggung Jawab silahkan hubungi pendaftran
                                </div>
                              </div>
                            </div> 
                            
                        </div>
                                <div class="flex min-h-screen">
            <div class="mb-6 gap-6 text-sm">
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-bold text-gray-900">Data Tindakan</h2>
                    </div>

                    <!-- Filters -->
                    <div class="mb-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Cari Tindakan / Dokter / Lokasi</label>
                            <input id="searchInput" type="text" placeholder="Cari" class="w-full py-3 px-4 pe-9 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none bg-white transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal Tindakan</label>
                            <div class="flex items-center space-x-3">
                                <div class="relative flex-1">
                                    <input id="tanggalFilter" type="date" class="w-full px-4 py-3 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                    <svg class="absolute right-3 top-3 w-4 h-4 text-gray-400 pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                                    </svg>
                                </div>
                                <button id="resetFilterBtn" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm">
                                    Reset
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Table -->
                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-800 uppercase">No.</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-800 uppercase">Tanggal Tindakan</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-800 uppercase">Lokasi Pelayanan</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-800 uppercase">Nama Tindakan</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-800 uppercase">Dokter PJ</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-800 uppercase">Catatan Medis</th>
                                    <th scope="col" class="px-6 py-3 text-start text-xs font-bold text-gray-800 uppercase">Status</th>
                                </tr>
                            </thead>
                            <tbody id="tindakanTable">
                                <tr class="border-b border-gray-100 hover:bg-gray-50 transition-colors">
                                    <td class="py-4 px-4">1</td>
                                    <td class="py-4 px-4">18 Juni 2025</td>
                                    <td class="py-4 px-4">Poli Umum</td>
                                    <td class="py-4 px-4">Pemeriksaan Fisik</td>
                                    <td class="py-4 px-4">dr. Julian Amato</td>
                                    <td class="py-4 px-4">
                                        <div class="flex items-center space-x-1">
                                            <span class="text-sm text-gray-600">Tensi cukup tinggi, Hipertensi</span>
                                            <button class="text-blue-600 hover:text-blue-800 transition-transform" onclick="toggleDetail(1)">
                                                <svg id="chevron1" class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                                </svg>
                                            </button>
                                        </div>
                                        <div id="detail1" class="detail-collapsed mt-2 p-3 bg-gray-50 rounded text-sm">
                                            <p class="mb-2"><strong>Diagnosis:</strong> Hipertensi Primer (I10)</p>
                                            <p class="mb-2"><strong>Tekanan Darah:</strong> 160/95 mmHg</p>
                                            <p class="mb-2"><strong>Nadi:</strong> 88 bpm</p>
                                            <p class="mb-2"><strong>Suhu:</strong> 36.5째C</p>
                                            <p class="mb-2"><strong>Resep:</strong> Amlodipine 5mg 1x1, Captopril 25mg 2x1</p>
                                            <button onclick="openDetailModal(1)" class="text-blue-600 hover:underline">Lihat Detail Lengkap</button>
                                        </div>
                                    </td>
                                    <td class="py-4 px-4">
                                        <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">Dirujuk ke Poli Penyakit Dalam</span>
                                    </td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50 transition-colors">
                                    <td class="py-4 px-4">2</td>
                                    <td class="py-4 px-4">18 Juli 2025</td>
                                    <td class="py-4 px-4">Poli Penyakit Dalam</td>
                                    <td class="py-4 px-4">Pemeriksaan Fisik</td>
                                    <td class="py-4 px-4">dr. Sho</td>
                                    <td class="py-4 px-4">
                                        <div class="flex items-center space-x-1">
                                            <span class="text-sm text-gray-600">Tensi sudah terkontrol</span>
                                            <button class="text-blue-600 hover:text-blue-800 transition-transform" onclick="toggleDetail(2)">
                                                <svg id="chevron2" class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                                </svg>
                                            </button>
                                        </div>
                                        <div id="detail2" class="detail-collapsed mt-2 p-3 bg-gray-50 rounded text-sm">
                                            <p class="mb-2"><strong>Diagnosis:</strong> Hipertensi Terkontrol</p>
                                            <p class="mb-2"><strong>Tekanan Darah:</strong> 130/80 mmHg</p>
                                            <p class="mb-2"><strong>Nadi:</strong> 78 bpm</p>
                                            <p class="mb-2"><strong>Suhu:</strong> 36.2째C</p>
                                            <p class="mb-2"><strong>Resep:</strong> Lanjut Amlodipine 5mg 1x1</p>
                                            <p class="mb-2"><strong>Anjuran:</strong> Kontrol 3 bulan lagi, diet rendah garam</p>
                                            <button onclick="openDetailModal(2)" class="text-blue-600 hover:underline">Lihat Detail Lengkap</button>
                                        </div>
                                    </td>

                                    <td class="py-4 px-4">
                                        <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">Pulang</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination -->
                    <div class="flex items-center justify-center space-x-2 mt-6">
                        <button class="px-3 py-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                        </button>
                        <button class="px-3 py-2 bg-blue-600 text-white rounded-lg">1</button>
                        <button class="px-3 py-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <!-- Modal for Detail Pemeriksaan -->
                <div id="detailModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4 text-sm">
                    <div class="bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl relative">
                        <div class="pt-6 pr-6 pl-6 rounded-t-xl flex justify-between items-center">
                            <h2 class="text-xl font-semibold">Detail Pemeriksaan</h2>
                            <button onclick="closeDetailModal()" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white hover:bg-opacity-20 transition-colors duration-200 text-2xl">
                                &times;
                            </button>
                        </div>
                        <div id="modalContent" class="p-6"></div>
                    </div>
                </div>
        </div>

        </div>
      </div>
    </div>

    <script>
      // Data dummy pasien - sama seperti di dashboard
      const patientData = [
        {
          id: 1,
          date: "16/07/2025",
          nrm: "000001",
          name: "Muhammad Fadhlan",
          nik: "3173012300010001",
          gender: "L",
          clinic: "Poli Bedah Ortopedi",
          doctor: "dr. Budi Sp.OT",
          payment: "Umum",
          action: "Pulang",
          phone: "081234567890",
          email: "fadhlan@email.com",
          birthDate: "23/01/1990",
          address: "Jl. Merdeka No. 123, Jakarta Pusat",
          allergies: "Tidak ada",
          specialConditions: "Tidak ada",
          queueNumber: "001",
          rujukanNumber: "RUJ-2025-001",
          bpjsNumber: "-",
          penanggungJawab: "Siti Fadhlan",
          hubunganPasien: "Istri"
        },
        {
          id: 2,
          date: "16/07/2025",
          nrm: "000002",
          name: "Siti Nurhaliza",
          nik: "3173012300020002",
          gender: "P",
          clinic: "Poli Gigi",
          doctor: "drg. Andi Prasetyo, Sp.KG",
          payment: "BPJS",
          action: "Pindah Poli",
          phone: "081234567891",
          email: "siti@email.com",
          birthDate: "15/03/1985",
          address: "Jl. Sudirman No. 456, Jakarta Selatan",
          allergies: "Penisilin",
          specialConditions: "Diabetes",
          queueNumber: "002",
          rujukanNumber: "RUJ-2025-002",
          bpjsNumber: "0001234567890",
          penanggungJawab: "Ahmad Nurhaliza",
          hubunganPasien: "Suami"
        },
        {
          id: 3,
          date: "16/07/2025",
          nrm: "000003",
          name: "Ahmad Yusuf",
          nik: "3173012300030003",
          gender: "L",
          clinic: "Poli Umum",
          doctor: "dr. Sarah",
          payment: "Umum",
          action: "Rawat Inap",
          phone: "081234567892",
          email: "ahmad@email.com",
          birthDate: "10/08/1992",
          address: "Jl. Thamrin No. 789, Jakarta Pusat",
          allergies: "Sulfa",
          specialConditions: "Hipertensi",
          queueNumber: "003",
          rujukanNumber: "RUJ-2025-003",
          bpjsNumber: "-",
          penanggungJawab: "Rina Yusuf",
          hubunganPasien: "Istri"
        },
        {
          id: 4,
          date: "16/07/2025",
          nrm: "000004",
          name: "Rina Sari",
          nik: "3173012300040004",
          gender: "P",
          clinic: "Poli Bedah Ortopedi",
          doctor: "dr. Budi Sp.OT",
          payment: "BPJS",
          action: "Pulang",
          phone: "081234567893",
          email: "rina@email.com",
          birthDate: "22/12/1988",
          address: "Jl. Gatot Subroto No. 321, Jakarta Selatan",
          allergies: "Ibuprofen",
          specialConditions: "Tidak ada",
          queueNumber: "004",
          rujukanNumber: "RUJ-2025-004",
          bpjsNumber: "0001234567891",
          penanggungJawab: "Budi Sari",
          hubunganPasien: "Suami"
        },
        {
          id: 5,
          date: "16/07/2025",
          nrm: "000005",
          name: "Budi Santoso",
          nik: "3173012300050005",
          gender: "L",
          clinic: "Poli Gigi",
          doctor: "drg. Andi Prasetyo, Sp.KG",
          payment: "Umum",
          action: "Pulang",
          phone: "081234567894",
          email: "budi@email.com",
          birthDate: "05/05/1987",
          address: "Jl. Kuningan No. 654, Jakarta Selatan",
          allergies: "Tidak ada",
          specialConditions: "Tidak ada",
          queueNumber: "005",
          rujukanNumber: "RUJ-2025-005",
          bpjsNumber: "-",
          penanggungJawab: "Dewi Santoso",
          hubunganPasien: "Istri"
        },
        {
          id: 6,
          date: "16/07/2025",
          nrm: "000006",
          name: "Dewi Lestari",
          nik: "3173012300060006",
          gender: "P",
          clinic: "Poli Umum",
          doctor: "dr. Sarah",
          payment: "BPJS",
          action: "Pindah Poli",
          phone: "081234567895",
          email: "dewi@email.com",
          birthDate: "18/11/1991",
          address: "Jl. Kemang No. 987, Jakarta Selatan",
          allergies: "Aspirin",
          specialConditions: "Asma",
          queueNumber: "006",
          rujukanNumber: "RUJ-2025-006",
          bpjsNumber: "0001234567892",
          penanggungJawab: "Agus Lestari",
          hubunganPasien: "Suami"
        },
        {
          id: 7,
          date: "16/07/2025",
          nrm: "000007",
          name: "Agus Wijaya",
          nik: "3173012300070007",
          gender: "L",
          clinic: "Poli Bedah Ortopedi",
          doctor: "dr. Budi Sp.OT",
          payment: "Umum",
          action: "Pulang",
          phone: "081234567896",
          email: "agus@email.com",
          birthDate: "12/09/1989",
          address: "Jl. Senayan No. 456, Jakarta Pusat",
          allergies: "Tidak ada",
          specialConditions: "Tidak ada",
          queueNumber: "007",
          rujukanNumber: "RUJ-2025-007",
          bpjsNumber: "-",
          penanggungJawab: "Maya Wijaya",
          hubunganPasien: "Istri"
        },
        {
          id: 8,
          date: "16/07/2025",
          nrm: "000008",
          name: "Maya Indira",
          nik: "3173012300080008",
          gender: "P",
          clinic: "Poli Gigi",
          doctor: "drg. Andi Prasetyo, Sp.KG",
          payment: "BPJS",
          action: "Rawat Inap",
          phone: "081234567897",
          email: "maya@email.com",
          birthDate: "07/04/1993",
          address: "Jl. Pondok Indah No. 321, Jakarta Selatan",
          allergies: "Antibiotik",
          specialConditions: "Gastritis",
          queueNumber: "008",
          rujukanNumber: "RUJ-2025-008",
          bpjsNumber: "0001234567893",
          penanggungJawab: "Roni Indira",
          hubunganPasien: "Suami"
        },
        {
          id: 9,
          date: "16/07/2025",
          nrm: "000009",
          name: "Roni Susanto",
          nik: "3173012300090009",
          gender: "L",
          clinic: "Poli Umum",
          doctor: "dr. Sarah",
          payment: "Umum",
          action: "Pulang",
          phone: "081234567898",
          email: "roni@email.com",
          birthDate: "25/02/1986",
          address: "Jl. Cipete No. 654, Jakarta Selatan",
          allergies: "Tidak ada",
          specialConditions: "Kolesterol",
          queueNumber: "009",
          rujukanNumber: "RUJ-2025-009",
          bpjsNumber: "-",
          penanggungJawab: "Lisa Susanto",
          hubunganPasien: "Istri"
        },
        {
          id: 10,
          date: "16/07/2025",
          nrm: "000010",
          name: "Lisa Amelia",
          nik: "3173012300100010",
          gender: "P",
          clinic: "Poli Bedah Ortopedi",
          doctor: "dr. Budi Sp.OT",
          payment: "BPJS",
          action: "Pindah Poli",
          phone: "081234567899",
          email: "lisa@email.com",
          birthDate: "14/06/1994",
          address: "Jl. Blok M No. 789, Jakarta Selatan",
          allergies: "Lateks",
          specialConditions: "Tidak ada",
          queueNumber: "010",
          rujukanNumber: "RUJ-2025-010",
          bpjsNumber: "0001234567894",
          penanggungJawab: "Agus Amelia",
          hubunganPasien: "Suami"
        }
      ];

      // Data dummy riwayat kunjungan per pasien
      const visitHistory = {
        1: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Bedah Ortopedi",
            doctor: "dr. Budi Sp.OT",
            diagnosis: "Fraktur Radius",
            treatment: "Pemasangan gips",
            status: "Selesai"
          },
          {
            id: 2,
            date: "02/07/2025",
            clinic: "Poli Umum",
            doctor: "dr. Sarah",
            diagnosis: "Hipertensi",
            treatment: "Terapi obat",
            status: "Selesai"
          }
        ],
        2: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Gigi",
            doctor: "drg. Andi Prasetyo, Sp.KG",
            diagnosis: "Karies Gigi",
            treatment: "Penambalan gigi",
            status: "Selesai"
          }
        ],
        3: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Umum",
            doctor: "dr. Sarah",
            diagnosis: "Gastritis",
            treatment: "Terapi obat",
            status: "Rawat Inap"
          }
        ],
        4: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Bedah Ortopedi",
            doctor: "dr. Budi Sp.OT",
            diagnosis: "Cedera Ligamen",
            treatment: "Fisioterapi",
            status: "Selesai"
          }
        ],
        5: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Gigi",
            doctor: "drg. Andi Prasetyo, Sp.KG",
            diagnosis: "Gingivitis",
            treatment: "Scaling gigi",
            status: "Selesai"
          }
        ],
        6: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Umum",
            doctor: "dr. Sarah",
            diagnosis: "Diabetes Mellitus",
            treatment: "Terapi insulin",
            status: "Pindah Poli"
          }
        ],
        7: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Bedah Ortopedi",
            doctor: "dr. Budi Sp.OT",
            diagnosis: "Patah Tulang",
            treatment: "Operasi",
            status: "Selesai"
          }
        ],
        8: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Gigi",
            doctor: "drg. Andi Prasetyo, Sp.KG",
            diagnosis: "Abses Gigi",
            treatment: "Pencabutan gigi",
            status: "Rawat Inap"
          }
        ],
        9: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Umum",
            doctor: "dr. Sarah",
            diagnosis: "Kolesterol Tinggi",
            treatment: "Diet dan obat",
            status: "Selesai"
          }
        ],
        10: [
          {
            id: 1,
            date: "16/07/2025",
            clinic: "Poli Bedah Ortopedi",
            doctor: "dr. Budi Sp.OT",
            diagnosis: "Keseleo",
            treatment: "Fisioterapi",
            status: "Pindah Poli"
          }
        ]
      };

      // Variabel untuk pagination
      let currentPage = 1;
      let itemsPerPage = 10;
      let filteredVisits = [];
      let currentPatient = null;

      // Fungsi untuk mendapatkan parameter URL
      function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
      }

      // Fungsi untuk mendapatkan badge class berdasarkan aksi
      function getActionBadgeClass(action) {
        switch (action) {
          case "Pulang":
            return "bg-green-100 text-green-800";
          case "Rawat Inap":
            return "bg-red-100 text-red-800";
          case "Pindah Poli":
            return "bg-yellow-100 text-yellow-800";
          default:
            return "bg-gray-100 text-gray-800";
        }
      }

      // Fungsi untuk memuat data pasien
      function loadPatientData() {
        const patientId = parseInt(getUrlParameter('id'));
        
        if (!patientId) {
          // Jika tidak ada ID, ambil pasien pertama sebagai default
          currentPatient = patientData[0];
        } else {
          currentPatient = patientData.find(p => p.id === patientId);
          
          if (!currentPatient) {
            // Jika ID tidak ditemukan, ambil pasien pertama
            currentPatient = patientData[0];
          }
        }

        // Isi data pasien ke elemen HTML
        document.getElementById('patientName').textContent = currentPatient.name;
        document.getElementById('patientNRM').textContent = `NRM: ${currentPatient.nrm}`;
        document.getElementById('patientRegDate').textContent = `Tanggal Terdaftar: ${currentPatient.date}`;
        
        document.getElementById('regNumber').textContent = `REG-${currentPatient.date.replace(/\//g, '')}-${currentPatient.nrm}`;
        document.getElementById('nikNumber').textContent = currentPatient.nik;
        document.getElementById('gender').textContent = currentPatient.gender === 'L' ? 'Laki-laki' : 'Perempuan';
        document.getElementById('birthDate').textContent = currentPatient.birthDate;
        document.getElementById('address').textContent = currentPatient.address;
        
        document.getElementById('clinic').textContent = currentPatient.clinic;
        document.getElementById('doctor').textContent = currentPatient.doctor;
        document.getElementById('payment').textContent = currentPatient.payment;
        document.getElementById('rujukanNumber').textContent = currentPatient.rujukanNumber;
        document.getElementById('bpjsNumber').textContent = currentPatient.bpjsNumber;
        
        document.getElementById('phoneNumber').textContent = currentPatient.phone;
        document.getElementById('allergies').textContent = currentPatient.allergies;
        document.getElementById('specialConditions').textContent = currentPatient.specialConditions;
        document.getElementById('penanggungJawab').textContent = currentPatient.penanggungJawab;
        document.getElementById('hubunganPasien').textContent = currentPatient.hubunganPasien;

        // Muat riwayat kunjungan
        loadVisitHistory();
      }

      // Fungsi untuk memuat riwayat kunjungan
      function loadVisitHistory() {
        if (!currentPatient) return;
        
        const visits = visitHistory[currentPatient.id] || [];
        filteredVisits = [...visits];
        displayVisits();
      }

      // Fungsi untuk menampilkan riwayat kunjungan
      function displayVisits() {
        const tbody = document.getElementById('visitTable');
        tbody.innerHTML = '';

        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const visitsToShow = filteredVisits.slice(startIndex, endIndex);

        visitsToShow.forEach((visit, index) => {
          const row = document.createElement('tr');
          row.className = 'hover:bg-gray-50';
          
          const statusClass = visit.status === 'Selesai' ? 'bg-green-100 text-green-800' : 
                             visit.status === 'Rawat Inap' ? 'bg-red-100 text-red-800' : 
                             'bg-yellow-100 text-yellow-800';

          row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              ${startIndex + index + 1}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              ${visit.date}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              ${visit.clinic}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              ${visit.doctor}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              ${visit.diagnosis}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              ${visit.treatment}
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${statusClass}">
                ${visit.status}
              </span>
            </td>
          `;
          
          tbody.appendChild(row);
        });

        updatePagination();
      }

      // Fungsi untuk update pagination
      function updatePagination() {
        const totalPages = Math.ceil(filteredVisits.length / itemsPerPage);
        const startItem = (currentPage - 1) * itemsPerPage + 1;
        const endItem = Math.min(currentPage * itemsPerPage, filteredVisits.length);

        document.getElementById('showingStart').textContent = filteredVisits.length > 0 ? startItem : 0;
        document.getElementById('showingEnd').textContent = endItem;
        document.getElementById('totalVisits').textContent = filteredVisits.length;

        // Update tombol prev/next
        document.getElementById('prevBtn').disabled = currentPage <= 1;
        document.getElementById('nextBtn').disabled = currentPage >= totalPages;

        // Update page numbers
        const pageNumbers = document.getElementById('pageNumbers');
        pageNumbers.innerHTML = '';
        
        for (let i = 1; i <= totalPages; i++) {
          const button = document.createElement('button');
          button.textContent = i;
          button.className = `px-3 py-2 text-sm rounded-lg ${
            i === currentPage 
              ? 'bg-blue-600 text-white' 
              : 'text-gray-500 hover:text-gray-700 hover:bg-gray-100'
          }`;
          button.onclick = () => goToPage(i);
          pageNumbers.appendChild(button);
        }
      }

      // Fungsi navigasi pagination
      function prevPage() {
        if (currentPage > 1) {
          currentPage--;
          displayVisits();
        }
      }

      function nextPage() {
        const totalPages = Math.ceil(filteredVisits.length / itemsPerPage);
        if (currentPage < totalPages) {
          currentPage++;
          displayVisits();
        }
      }

      function goToPage(page) {
        currentPage = page;
        displayVisits();
      }

      // Fungsi filter
      function applyVisitFilter() {
        if (!currentPatient) return;
        
        const searchTerm = document.getElementById('searchVisit').value.toLowerCase();
        const dateFilter = document.getElementById('dateFilter').value;
        const clinicFilter = document.getElementById('clinicFilter').value;
        
        const allVisits = visitHistory[currentPatient.id] || [];
        
        filteredVisits = allVisits.filter(visit => {
          const matchesSearch = !searchTerm || 
            visit.diagnosis.toLowerCase().includes(searchTerm) ||
            visit.treatment.toLowerCase().includes(searchTerm) ||
            visit.doctor.toLowerCase().includes(searchTerm);
            
          const matchesDate = !dateFilter || visit.date === dateFilter;
          const matchesClinic = !clinicFilter || visit.clinic === clinicFilter;
          
          return matchesSearch && matchesDate && matchesClinic;
        });
        
        currentPage = 1;
        displayVisits();
      }

      function resetVisitFilter() {
        document.getElementById('searchVisit').value = '';
        document.getElementById('dateFilter').value = '';
        document.getElementById('clinicFilter').value = '';
        loadVisitHistory();
      }

      // Fungsi untuk kembali ke dashboard
      function goBack() {
        window.location.href = 'dashboard.html';
      }

      // Event listeners
      document.addEventListener('DOMContentLoaded', function() {
        loadPatientData();
        
        // Event listeners untuk filter
        document.getElementById('searchVisit').addEventListener('input', applyVisitFilter);
        document.getElementById('dateFilter').addEventListener('change', applyVisitFilter);
        document.getElementById('clinicFilter').addEventListener('change', applyVisitFilter);
      });

        function toggleDetail(id) {
            const detail = document.getElementById(`detail${id}`);
            const chevron = document.getElementById(`chevron${id}`);
            
            if (detail.classList.contains('detail-collapsed')) {
                detail.classList.remove('detail-collapsed');
                detail.classList.add('detail-expanded');
                chevron.classList.add('rotate-180');
            } else {
                detail.classList.remove('detail-expanded');
                detail.classList.add('detail-collapsed');
                chevron.classList.remove('rotate-180');
            }
        }

        function toggleAction(id) {
            const menu = document.getElementById(`actionMenu${id}`);
            const allMenus = document.querySelectorAll('[id^="actionMenu"]');
            
            // Close all other menus
            allMenus.forEach(m => {
                if (m.id !== `actionMenu${id}`) {
                    m.classList.add('hidden');
                }
            });
            
            menu.classList.toggle('hidden');
        }

        document.addEventListener('click', function(event) {
            if (!event.target.closest('[onclick^="toggleAction"]') && !event.target.closest('[id^="actionMenu"]')) {
                const allMenus = document.querySelectorAll('[id^="actionMenu"]');
                allMenus.forEach(menu => menu.classList.add('hidden'));
            }
        });

        // Open detail modal
        function openDetailModal(id) {
            const modal = document.getElementById('detailModal');
            const content = document.getElementById('modalContent');
            
            // Sample data based on id
            const data = {
                1: {
                    tanggal: '18 Juni 2025',
                    lokasi: 'Poli Umum',
                    tindakan: 'Pemeriksaan Fisik',
                    dokter: 'dr. Julian Amato',
                    diagnosis: 'Hipertensi Primer (I10)',
                    td: '160/95 mmHg',
                    nadi: '88 bpm',
                    suhu: '36.5째C',
                    bb: '75 kg',
                    tb: '170 cm',
                    keluhan: 'Sakit kepala, pusing terutama pagi hari',
                    pemeriksaan: 'Pasien tampak sakit ringan, kesadaran compos mentis',
                    resep: 'Amlodipine 5mg 1x1, Captopril 25mg 2x1',
                    anjuran: 'Diet rendah garam, olahraga teratur, kontrol 2 minggu'
                },
                2: {
                    tanggal: '18 Juli 2025',
                    lokasi: 'Poli Penyakit Dalam',
                    tindakan: 'Pemeriksaan Fisik',
                    dokter: 'dr. Sho',
                    diagnosis: 'Hipertensi Terkontrol',
                    td: '130/80 mmHg',
                    nadi: '78 bpm',
                    suhu: '36.2째C',
                    bb: '73 kg',
                    tb: '170 cm',
                    keluhan: 'Tidak ada keluhan khusus',
                    pemeriksaan: 'Pasien tampak sehat, tekanan darah terkontrol',
                    resep: 'Lanjut Amlodipine 5mg 1x1',
                    anjuran: 'Diet rendah garam, olahraga teratur, kontrol 3 bulan lagi'
                }
            };

            const item = data[id];
            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <p class="mb-2"><strong>Tanggal:</strong> ${item.tanggal}</p>
                        <p class="mb-2"><strong>Lokasi:</strong> ${item.lokasi}</p>
                        <p class="mb-2"><strong>Tindakan:</strong> ${item.tindakan}</p>
                        <p class="mb-2"><strong>Dokter PJ:</strong> ${item.dokter}</p>
                        <p class="mb-2"><strong>Diagnosis:</strong> ${item.diagnosis}</p>
                    </div>
                    <div>
                        <p class="mb-2"><strong>Tekanan Darah:</strong> ${item.td}</p>
                        <p class="mb-2"><strong>Nadi:</strong> ${item.nadi}</p>
                        <p class="mb-2"><strong>Suhu:</strong> ${item.suhu}</p>
                        <p class="mb-2"><strong>Berat Badan:</strong> ${item.bb}</p>
                        <p class="mb-2"><strong>Tinggi Badan:</strong> ${item.tb}</p>
                    </div>
                </div>
                <div class="mt-4">
                    <p class="mb-2"><strong>Keluhan Utama:</strong> ${item.keluhan}</p>
                    <p class="mb-2"><strong>Pemeriksaan Fisik:</strong> ${item.pemeriksaan}</p>
                    <p class="mb-2"><strong>Resep Obat:</strong> ${item.resep}</p>
                    <p class="mb-2"><strong>Anjuran:</strong> ${item.anjuran}</p>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        // Close detail modal
        function closeDetailModal() {
            document.getElementById('detailModal').classList.add('hidden');
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#tindakanTable tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                if (text.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });

        // Date filter
        document.getElementById('tanggalFilter').addEventListener('change', function(e) {
            const filterDate = e.target.value;
            const rows = document.querySelectorAll('#tindakanTable tr');
            
            if (!filterDate) return;
            
            rows.forEach(row => {
                const dateCell = row.cells[1];
                if (dateCell) {
                    row.style.display = '';
                }
            });
        });

        // Reset filters
        document.getElementById('resetFilterBtn').addEventListener('click', function() {
            document.getElementById('searchInput').value = '';
            document.getElementById('tanggalFilter').value = '';
            
            const rows = document.querySelectorAll('#tindakanTable tr');
            rows.forEach(row => {
                row.style.display = '';
            });
        });
    </script>

    <style>
      .font-inter {
        font-family: "Inter", sans-serif;
      }
    </style>
  </body>
</html>